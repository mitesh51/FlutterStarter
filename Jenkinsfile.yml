pipeline:
 
 agent:
  label: 'master'
  
 stages:
  - stage: 'Flutter Doctor'
    steps:
     - bat 'flutter doctor'
     
  - stage: 'SCA'
    steps:
     - bat 'flutter analyze'    
     - bat 'flutter pub get && flutter pub global activate junitreport && flutter test --machine | tojunit --output test.xml'
     - junit 'test.xml'
     - bat 'flutter test --coverage &&  python C:\\Python38\\Lib\\site-packages\\lcov_cobertura.py coverage\\lcov.info'
  - stage: 'Build'
    steps:
     - bat 'flutter build apk --%BUILD_TYPE%'
     - archiveArtifacts '**/*.apk'

# Define post actions
 post:
   always:
     - cleanWs()    